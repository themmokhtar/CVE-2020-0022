#include "errors.h"
#include "bluetooth.h"

err_t leak_simple(const int hci_sock_fd, const uint16_t hci_handle, const int l2cap_sock_fd, uint8_t *const packet_id, struct bluetooth_l2cap_header **packet);
err_t leak_fancy(const int hci_sock_fd, const uint16_t hci_handle, const int l2cap_sock_fd, uint8_t *const packet_id, bool (*const leak_callback)(uint8_t *data, size_t data_size, void *private), void *private);
err_t leak_libandroid_runtime_base(const int hci_sock_fd, const uint16_t hci_handle, const int l2cap_sock_fd, uint8_t *const packet_id, uint64_t *const libandroid_runtime_base);
err_t leak_packet_address(const int hci_sock_fd, const uint16_t hci_handle, const int l2cap_sock_fd, uint8_t *const packet_id, uint64_t *const packet_address);
